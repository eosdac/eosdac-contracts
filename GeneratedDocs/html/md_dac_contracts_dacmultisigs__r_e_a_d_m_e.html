<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EOSDAC: dacmultisigs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EOSDAC
   </div>
   <div id="projectbrief">Open source decentralised DAC platform for EOSIO blockchains</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_dac_contracts_dacmultisigs__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">dacmultisigs </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>eosDAC multi-signature proposal contract management. This contract keeps a record of system-level multisig proposals which are of interest to the custodians of a DAC. At the same time (preferably in the same transaction) as the initial eosio.msig proposal, the custodian should call the <code>proposed</code> action with some metadata about the proposal. The <code>proposed</code> action will record the details about the proposal as well as the transaction id in the <code>proposals</code> table.</p>
<p>Off-chain processes can then read the transaction id from the database and then fetch the transaction referenced and read the metadata.</p>
<p>Approvals, cancellations etc must also be notified, this will update the <code>modifieddate</code> entry in the database. Proposals without any activity in 2 weeks can be removed from the database to free RAM using the <code>clean</code> action.</p>
<h1><a class="anchor" id="autotoc_md199"></a>
Tables:</h1>
<h2><a class="anchor" id="autotoc_md200"></a>
proposals</h2>
<p>Stored in the scope of the respective</p>
<ul>
<li><code>proposalname</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS)</li>
<li><code>transactionid</code> (string) - transaction id containing the metadata for a proposal.</li>
<li><code>modifieddate</code> (uint32) - timestamp of last activity on this proposal, used to allow cleaning of abandoned proposals</li>
</ul>
<h1><a class="anchor" id="autotoc_md201"></a>
Actions</h1>
<h2><a class="anchor" id="autotoc_md202"></a>
proposed</h2>
<p>Should be called after proposing to the system multisig contract, the metadata will be ignored and the current transaction id will be stored so that external tools can fetch the metadata.</p>
<h4><a class="anchor" id="autotoc_md203"></a>
Assertions:</h4>
<ul>
<li>The action must be authorised by the <code>proposer</code> and <code>dacauthority@one</code> (ie they must be a currently elected custodian). There must be an entry in the eosio.msig <code>proposal</code> table with the scope of the proposer and primary key of the <code>proposal_name</code></li>
</ul>
<h4><a class="anchor" id="autotoc_md204"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
<li><code>metadata</code> (string) - JSON string with metadata about the proposal. Currently the metadata should be a JSON string with <code>name</code> and <code>description</code> properties.</li>
</ul>
<h4><a class="anchor" id="autotoc_md205"></a>
Postconditions:</h4>
<p>After success a new proposal will be added to the <code>proposals</code> table in this contract, with the current transaction id.</p>
<h2><a class="anchor" id="autotoc_md206"></a>
approved</h2>
<p>Signals that a proposal has been approved on the system msig contract.</p>
<h3><a class="anchor" id="autotoc_md207"></a>
Assertions:</h3>
<ul>
<li>The action must be authorised by the <code>approver</code> and <code>dacauthority@one</code> (ie they must be a currently elected custodian). There must be an entry in the eosio.msig <code>proposal</code> table with the scope of the proposer and primary key of the <code>proposal_name</code>.</li>
</ul>
<h4><a class="anchor" id="autotoc_md208"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
<li><code>approver</code> (name) - account name which approved the proposal</li>
</ul>
<h4><a class="anchor" id="autotoc_md209"></a>
Postconditions:</h4>
<p>The <code>modifieddate</code> will be updated for this proposal.</p>
<h2><a class="anchor" id="autotoc_md210"></a>
unapproved</h2>
<p>Signals that a proposal has been unapproved on the system msig contract.</p>
<h3><a class="anchor" id="autotoc_md211"></a>
Assertions:</h3>
<ul>
<li>The action must be authorised by the <code>unapprover</code> and <code>dacauthority@one</code> (ie they must be a currently elected custodian). There must be an entry in the eosio.msig <code>proposal</code> table with the scope of the proposer and primary key of the <code>proposal_name</code>.</li>
</ul>
<h4><a class="anchor" id="autotoc_md212"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
<li><code>unapprover</code> (name) - account name which unapproved the proposal</li>
</ul>
<h4><a class="anchor" id="autotoc_md213"></a>
Postconditions:</h4>
<p>The <code>modifieddate</code> will be updated for this proposal.</p>
<h2><a class="anchor" id="autotoc_md214"></a>
executed</h2>
<p>Notify the contract that you executed a proposal.</p>
<h3><a class="anchor" id="autotoc_md215"></a>
Assertions:</h3>
<ul>
<li>The action must be authorised by the <code>unapprover</code> and <code>dacauthority@one</code> (ie they must be a currently elected custodian). There must <em>NOT</em> be an entry in the eosio.msig <code>proposal</code> table with the scope of the proposer and primary key of the <code>proposal_name</code>.</li>
</ul>
<h4><a class="anchor" id="autotoc_md216"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
<li><code>executer</code> (name) - account name which executed the proposal</li>
</ul>
<h4><a class="anchor" id="autotoc_md217"></a>
Postconditions:</h4>
<p>The proposal will be removed from the database.</p>
<h2><a class="anchor" id="autotoc_md218"></a>
cancelled</h2>
<p>Notify the contract that you cancelled a proposal.</p>
<h3><a class="anchor" id="autotoc_md219"></a>
Assertions:</h3>
<ul>
<li>The action must be authorised by the <code>unapprover</code> and <code>dacauthority@one</code> (ie they must be a currently elected custodian). There must <em>NOT</em> be an entry in the eosio.msig <code>proposal</code> table with the scope of the proposer and primary key of the <code>proposal_name</code>.</li>
</ul>
<h4><a class="anchor" id="autotoc_md220"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
<li><code>canceler</code> (name) - account name which cancelled the proposal</li>
</ul>
<h4><a class="anchor" id="autotoc_md221"></a>
Postconditions:</h4>
<p>The proposal will be removed from the database.</p>
<h2><a class="anchor" id="autotoc_md222"></a>
clean</h2>
<p>Will remove a proposal from the database to free RAM.</p>
<h3><a class="anchor" id="autotoc_md223"></a>
Assertions:</h3>
<ul>
<li>The proposal being cleaned from the database must have a <code>modifieddate</code> more than 2 weeks in the past. Transaction must provide <code>dacauthority</code> permission.</li>
</ul>
<h4><a class="anchor" id="autotoc_md224"></a>
Parameters:</h4>
<ul>
<li><code>proposer</code> (name) - account name for the user making the proposal</li>
<li><code>proposal_name</code> (name) - name for the proposal (should follow the character limitations similar to the account names on EOS, but can be less than 12 characters)</li>
</ul>
<h4><a class="anchor" id="autotoc_md225"></a>
Postconditions:</h4>
<p>The proposal will be removed from the database. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
