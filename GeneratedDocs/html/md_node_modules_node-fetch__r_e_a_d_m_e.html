<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EOSDAC: node-fetch</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EOSDAC
   </div>
   <div id="projectbrief">Open source decentralised DAC platform for EOSIO blockchains</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_node_modules_node-fetch__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">node-fetch </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="https://www.npmjs.com/package/node-fetch"><img src="https://flat.badgen.net/npm/v/node-fetch" alt="npm version" class="inline"/></a> <a href="https://travis-ci.org/bitinn/node-fetch"><img src="https://flat.badgen.net/travis/bitinn/node-fetch" alt="build status" class="inline"/></a> <a href="https://codecov.io/gh/bitinn/node-fetch"><img src="https://flat.badgen.net/codecov/c/github/bitinn/node-fetch/master" alt="coverage status" class="inline"/></a> <a href="https://packagephobia.now.sh/result?p=node-fetch"><img src="https://flat.badgen.net/packagephobia/install/node-fetch" alt="install size" class="inline"/></a></p>
<p>A light-weight module that brings <code>window.fetch</code> to Node.js</p>
<p>(We are looking for <a href="https://github.com/bitinn/node-fetch/issues/567">v2 maintainers and collaborators</a>)</p>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#features">Features</a></li>
<li><a href="#difference-from-client-side-fetch">Difference from client-side fetch</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#loading-and-configuring-the-module">Loading and configuring the module</a></li>
<li><a href="#common-usage">Common Usage</a><ul>
<li><a href="#plain-text-or-html">Plain text or HTML</a></li>
<li><a href="#json">JSON</a></li>
<li><a href="#simple-post">Simple Post</a></li>
<li><a href="#post-with-json">Post with JSON</a></li>
<li><a href="#post-with-form-parameters">Post with form parameters</a></li>
<li><a href="#handling-exceptions">Handling exceptions</a></li>
<li><a href="#handling-client-and-server-errors">Handling client and server errors</a></li>
</ul>
</li>
<li><a href="#advanced-usage">Advanced Usage</a><ul>
<li><a href="#streams">Streams</a></li>
<li><a href="#buffer">Buffer</a></li>
<li><a href="#accessing-headers-and-other-meta-data">Accessing Headers and other Meta data</a></li>
<li><a href="#extract-set-cookie-header">Extract Set-Cookie Header</a></li>
<li><a href="#post-data-using-a-file-stream">Post data using a file stream</a></li>
<li><a href="#post-with-form-data-detect-multipart">Post with form-data (detect multipart)</a></li>
<li><a href="#request-cancellation-with-abortsignal">Request cancellation with AbortSignal</a></li>
</ul>
</li>
<li><a href="#api">API</a><ul>
<li><a href="#fetchurl-options">fetch(url[, options])</a></li>
<li><a href="#options">Options</a></li>
<li><a href="#class-request">Class: Request</a></li>
<li><a href="#class-response">Class: Response</a></li>
<li><a href="#class-headers">Class: Headers</a></li>
<li><a href="#interface-body">Interface: Body</a></li>
<li><a href="#class-fetcherror">Class: FetchError</a></li>
</ul>
</li>
<li><a href="#license">License</a></li>
<li><a href="#acknowledgement">Acknowledgement</a></li>
</ul>
<h1><a class="anchor" id="autotoc_md3197"></a>
Motivation</h1>
<p>Instead of implementing <code>XMLHttpRequest</code> in Node.js to run browser-specific <a href="https://github.com/github/fetch">Fetch polyfill</a>, why not go from native <code>http</code> to <code>fetch</code> API directly? Hence <code>node-fetch</code>, minimal code for a <code>window.fetch</code> compatible API on Node.js runtime.</p>
<p>See Matt Andrews' <a href="https://github.com/matthew-andrews/isomorphic-fetch">isomorphic-fetch</a> or Leonardo Quixada's <a href="https://github.com/lquixada/cross-fetch">cross-fetch</a> for isomorphic usage (exports <code>node-fetch</code> for server-side, <code>whatwg-fetch</code> for client-side).</p>
<h1><a class="anchor" id="autotoc_md3198"></a>
Features</h1>
<ul>
<li>Stay consistent with <code>window.fetch</code> API.</li>
<li>Make conscious trade-off when following <a href="https://fetch.spec.whatwg.org/">WHATWG fetch spec</a> and <a href="https://streams.spec.whatwg.org/">stream spec</a> implementation details, document known differences.</li>
<li>Use native promise, but allow substituting it with [insert your favorite promise library].</li>
<li>Use native Node streams for body, on both request and response.</li>
<li>Decode content encoding (gzip/deflate) properly, and convert string output (such as <code>res.text()</code> and <code>res.json()</code>) to UTF-8 automatically.</li>
<li>Useful extensions such as timeout, redirect limit, response size limit, explicit errors for troubleshooting.</li>
</ul>
<h1><a class="anchor" id="autotoc_md3199"></a>
Difference from client-side fetch</h1>
<ul>
<li>See Known Differences for details.</li>
<li>If you happen to use a missing feature that <code>window.fetch</code> offers, feel free to open an issue.</li>
<li>Pull requests are welcomed too!</li>
</ul>
<h1><a class="anchor" id="autotoc_md3200"></a>
Installation</h1>
<p>Current stable release (<code>2.x</code>)</p>
<div class="fragment"><div class="line">$ npm install node-fetch --save</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3201"></a>
Loading and configuring the module</h1>
<p>We suggest you load the module via <code>require</code>, pending the stabalizing of es modules in node: </p><div class="fragment"><div class="line">const fetch = require(&#39;node-fetch&#39;);</div>
</div><!-- fragment --><p>If you are using a Promise library other than native, set it through fetch.Promise: </p><div class="fragment"><div class="line">const Bluebird = require(&#39;bluebird&#39;);</div>
<div class="line"> </div>
<div class="line">fetch.Promise = Bluebird;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3202"></a>
Common Usage</h1>
<p>NOTE: The documentation below is up-to-date with <code>2.x</code> releases, <a href="https://github.com/bitinn/node-fetch/blob/1.x/README.md">see <code>1.x</code> readme</a>, <a href="https://github.com/bitinn/node-fetch/blob/1.x/CHANGELOG.md">changelog</a> and 2.x upgrade guide for the differences.</p>
<h3><a class="anchor" id="autotoc_md3203"></a>
Plain text or HTML</h3>
<div class="fragment"><div class="line">fetch(&#39;https://github.com/&#39;)</div>
<div class="line">    .then(res =&gt; res.text())</div>
<div class="line">    .then(body =&gt; console.log(body));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3204"></a>
JSON</h3>
<div class="fragment"><div class="line">fetch(&#39;https://api.github.com/users/github&#39;)</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3205"></a>
Simple Post</h3>
<div class="fragment"><div class="line">fetch(&#39;https://httpbin.org/post&#39;, { method: &#39;POST&#39;, body: &#39;a=1&#39; })</div>
<div class="line">    .then(res =&gt; res.json()) // expecting a json response</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3206"></a>
Post with JSON</h3>
<div class="fragment"><div class="line">const body = { a: 1 };</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/post&#39;, {</div>
<div class="line">        method: &#39;post&#39;,</div>
<div class="line">        body:    JSON.stringify(body),</div>
<div class="line">        headers: { &#39;Content-Type&#39;: &#39;application/json&#39; },</div>
<div class="line">    })</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3207"></a>
Post with form parameters</h3>
<p><code>URLSearchParams</code> is available in Node.js as of v7.5.0. See <a href="https://nodejs.org/api/url.html#url_class_urlsearchparams">official documentation</a> for more usage methods.</p>
<p>NOTE: The <code>Content-Type</code> header is only set automatically to <code>x-www-form-urlencoded</code> when an instance of <code>URLSearchParams</code> is given as such:</p>
<div class="fragment"><div class="line">const { URLSearchParams } = require(&#39;url&#39;);</div>
<div class="line"> </div>
<div class="line">const params = new URLSearchParams();</div>
<div class="line">params.append(&#39;a&#39;, 1);</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/post&#39;, { method: &#39;POST&#39;, body: params })</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3208"></a>
Handling exceptions</h3>
<p>NOTE: 3xx-5xx responses are <em>NOT</em> exceptions, and should be handled in <code>then()</code>, see the next section.</p>
<p>Adding a catch to the fetch promise chain will catch <em>all</em> exceptions, such as errors originating from node core libraries, like network errors, and operational errors which are instances of FetchError. See the error handling document for more details.</p>
<div class="fragment"><div class="line">fetch(&#39;https://domain.invalid/&#39;)</div>
<div class="line">    .catch(err =&gt; console.error(err));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3209"></a>
Handling client and server errors</h3>
<p>It is common to create a helper function to check that the response contains no client (4xx) or server (5xx) error responses:</p>
<div class="fragment"><div class="line">function checkStatus(res) {</div>
<div class="line">    if (res.ok) { // res.status &gt;= 200 &amp;&amp; res.status &lt; 300</div>
<div class="line">        return res;</div>
<div class="line">    } else {</div>
<div class="line">        throw MyCustomError(res.statusText);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/status/400&#39;)</div>
<div class="line">    .then(checkStatus)</div>
<div class="line">    .then(res =&gt; console.log(&#39;will not get here...&#39;))</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3210"></a>
Advanced Usage</h1>
<h3><a class="anchor" id="autotoc_md3211"></a>
Streams</h3>
<p>The "Node.js way" is to use streams when possible:</p>
<div class="fragment"><div class="line">fetch(&#39;https://assets-cdn.github.com/images/modules/logos_page/Octocat.png&#39;)</div>
<div class="line">    .then(res =&gt; {</div>
<div class="line">        const dest = fs.createWriteStream(&#39;./octocat.png&#39;);</div>
<div class="line">        res.body.pipe(dest);</div>
<div class="line">    });</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3212"></a>
Buffer</h3>
<p>If you prefer to cache binary data in full, use buffer(). (NOTE: buffer() is a <code>node-fetch</code> only API)</p>
<div class="fragment"><div class="line">const fileType = require(&#39;file-type&#39;);</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://assets-cdn.github.com/images/modules/logos_page/Octocat.png&#39;)</div>
<div class="line">    .then(res =&gt; res.buffer())</div>
<div class="line">    .then(buffer =&gt; fileType(buffer))</div>
<div class="line">    .then(type =&gt; { /* ... */ });</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3213"></a>
Accessing Headers and other Meta data</h3>
<div class="fragment"><div class="line">fetch(&#39;https://github.com/&#39;)</div>
<div class="line">    .then(res =&gt; {</div>
<div class="line">        console.log(res.ok);</div>
<div class="line">        console.log(res.status);</div>
<div class="line">        console.log(res.statusText);</div>
<div class="line">        console.log(res.headers.raw());</div>
<div class="line">        console.log(res.headers.get(&#39;content-type&#39;));</div>
<div class="line">    });</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3214"></a>
Extract Set-Cookie Header</h3>
<p>Unlike browsers, you can access raw <code>Set-Cookie</code> headers manually using <code>Headers.raw()</code>, this is a <code>node-fetch</code> only API.</p>
<div class="fragment"><div class="line">fetch(url).then(res =&gt; {</div>
<div class="line">    // returns an array of values, instead of a string of comma-separated values</div>
<div class="line">    console.log(res.headers.raw()[&#39;set-cookie&#39;]);</div>
<div class="line">});</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3215"></a>
Post data using a file stream</h3>
<div class="fragment"><div class="line">const { createReadStream } = require(&#39;fs&#39;);</div>
<div class="line"> </div>
<div class="line">const stream = createReadStream(&#39;input.txt&#39;);</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/post&#39;, { method: &#39;POST&#39;, body: stream })</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3216"></a>
Post with form-data (detect multipart)</h3>
<div class="fragment"><div class="line">const FormData = require(&#39;form-data&#39;);</div>
<div class="line"> </div>
<div class="line">const form = new FormData();</div>
<div class="line">form.append(&#39;a&#39;, 1);</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/post&#39;, { method: &#39;POST&#39;, body: form })</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
<div class="line"> </div>
<div class="line">// OR, using custom headers</div>
<div class="line">// NOTE: getHeaders() is non-standard API</div>
<div class="line"> </div>
<div class="line">const form = new FormData();</div>
<div class="line">form.append(&#39;a&#39;, 1);</div>
<div class="line"> </div>
<div class="line">const options = {</div>
<div class="line">    method: &#39;POST&#39;,</div>
<div class="line">    body: form,</div>
<div class="line">    headers: form.getHeaders()</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">fetch(&#39;https://httpbin.org/post&#39;, options)</div>
<div class="line">    .then(res =&gt; res.json())</div>
<div class="line">    .then(json =&gt; console.log(json));</div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md3217"></a>
Request cancellation with AbortSignal</h3>
<blockquote class="doxtable">
<p>NOTE: You may only cancel streamed requests on Node &gt;= v8.0.0 </p>
</blockquote>
<p>You may cancel requests with <code>AbortController</code>. A suggested implementation is <a href="https://www.npmjs.com/package/abort-controller"><code>abort-controller</code></a>.</p>
<p>An example of timing out a request after 150ms could be achieved as follows:</p>
<div class="fragment"><div class="line">import AbortController from &#39;abort-controller&#39;;</div>
<div class="line"> </div>
<div class="line">const controller = new AbortController();</div>
<div class="line">const timeout = setTimeout(</div>
<div class="line">  () =&gt; { controller.abort(); },</div>
<div class="line">  150,</div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line">fetch(url, { signal: controller.signal })</div>
<div class="line">  .then(res =&gt; res.json())</div>
<div class="line">  .then(</div>
<div class="line">    data =&gt; {</div>
<div class="line">      useData(data)</div>
<div class="line">    },</div>
<div class="line">    err =&gt; {</div>
<div class="line">      if (err.name === &#39;AbortError&#39;) {</div>
<div class="line">        // request was aborted</div>
<div class="line">      }</div>
<div class="line">    },</div>
<div class="line">  )</div>
<div class="line">  .finally(() =&gt; {</div>
<div class="line">    clearTimeout(timeout);</div>
<div class="line">  });</div>
</div><!-- fragment --><p>See <a href="https://github.com/bitinn/node-fetch/blob/master/test/test.js">test cases</a> for more examples.</p>
<h1><a class="anchor" id="autotoc_md3218"></a>
API</h1>
<h2><a class="anchor" id="autotoc_md3219"></a>
fetch(url[, options])</h2>
<ul>
<li><code>url</code> A string representing the URL for fetching</li>
<li><code>options</code> <a href="#fetch-options">Options</a> for the HTTP(S) request</li>
<li>Returns: <code>Promise&lt;<a href="#class-response">Response</a>&gt;</code></li>
</ul>
<p>Perform an HTTP(S) fetch.</p>
<p><code>url</code> should be an absolute url, such as <code><a href="https://example.com/">https://example.com/</a></code>. A path-relative URL (<code>/file/under/root</code>) or protocol-relative URL (<code>//can-be-http-or-https.com/</code>) will result in a rejected promise.</p>
<p><a class="anchor" id="fetch-options"></a> </p>
<h2><a class="anchor" id="autotoc_md3220"></a>
Options</h2>
<p>The default values are shown after each option key.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    // These properties are part of the Fetch Standard</div>
<div class="line">    method: &#39;GET&#39;,</div>
<div class="line">    headers: {},        // request headers. format is the identical to that accepted by the Headers constructor (see below)</div>
<div class="line">    body: null,         // request body. can be null, a string, a Buffer, a Blob, or a Node.js Readable stream</div>
<div class="line">    redirect: &#39;follow&#39;, // set to `manual` to extract redirect headers, `error` to reject redirect</div>
<div class="line">    signal: null,       // pass an instance of AbortSignal to optionally abort requests</div>
<div class="line"> </div>
<div class="line">    // The following properties are node-fetch extensions</div>
<div class="line">    follow: 20,         // maximum redirect count. 0 to not follow redirect</div>
<div class="line">    timeout: 0,         // req/res timeout in ms, it resets on redirect. 0 to disable (OS limit applies). Signal is recommended instead.</div>
<div class="line">    compress: true,     // support gzip/deflate content encoding. false to disable</div>
<div class="line">    size: 0,            // maximum response body size in bytes. 0 to disable</div>
<div class="line">    agent: null         // http(s).Agent instance or function that returns an instance (see below)</div>
<div class="line">}</div>
</div><!-- fragment --><h4><a class="anchor" id="autotoc_md3221"></a>
Default Headers</h4>
<p>If no values are set, the following request headers will be sent automatically:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Header </th><th class="markdownTableHeadNone">Value  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Accept-Encoding</code> </td><td class="markdownTableBodyNone"><code>gzip,deflate</code> _(when <code>options.compress === true</code>)_  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Accept</code> </td><td class="markdownTableBodyNone"><code>*/*</code>  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Connection</code> </td><td class="markdownTableBodyNone"><code>close</code> _(when no <code>options.agent</code> is present)_  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>Content-Length</code> </td><td class="markdownTableBodyNone">_(automatically calculated, if possible)_  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>Transfer-Encoding</code> </td><td class="markdownTableBodyNone"><code>chunked</code> _(when <code>req.body</code> is a stream)_  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>User-Agent</code> </td><td class="markdownTableBodyNone"><code>node-fetch/1.0 (+<a href="https://github.com/bitinn/node-fetch">https://github.com/bitinn/node-fetch</a>)</code>  </td></tr>
</table>
<p>Note: when <code>body</code> is a <code>Stream</code>, <code>Content-Length</code> is not set automatically.</p>
<h4><a class="anchor" id="autotoc_md3222"></a>
Custom Agent</h4>
<p>The <code>agent</code> option allows you to specify networking related options that's out of the scope of Fetch. Including and not limit to:</p>
<ul>
<li>Support self-signed certificate</li>
<li>Use only IPv4 or IPv6</li>
<li>Custom DNS Lookup</li>
</ul>
<p>See <a href="https://nodejs.org/api/http.html#http_new_agent_options"><code>http.Agent</code></a> for more information.</p>
<p>In addition, <code>agent</code> option accepts a function that returns http(s).Agent instance given current <a href="https://nodejs.org/api/url.html">URL</a>, this is useful during a redirection chain across HTTP and HTTPS protocol.</p>
<div class="fragment"><div class="line">const httpAgent = new http.Agent({</div>
<div class="line">    keepAlive: true</div>
<div class="line">});</div>
<div class="line">const httpsAgent = new https.Agent({</div>
<div class="line">    keepAlive: true</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line">const options = {</div>
<div class="line">    agent: function (_parsedURL) {</div>
<div class="line">        if (_parsedURL.protocol == &#39;http:&#39;) {</div>
<div class="line">            return httpAgent;</div>
<div class="line">        } else {</div>
<div class="line">            return httpsAgent;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="class-request"></a> </p>
<h2><a class="anchor" id="autotoc_md3223"></a>
Class: Request</h2>
<p>An HTTP(S) request containing information about URL, method, headers, and the body. This class implements the <a href="#iface-body">Body</a> interface.</p>
<p>Due to the nature of Node.js, the following properties are not implemented at this moment:</p>
<ul>
<li><code>type</code></li>
<li><code>destination</code></li>
<li><code>referrer</code></li>
<li><code>referrerPolicy</code></li>
<li><code>mode</code></li>
<li><code>credentials</code></li>
<li><code>cache</code></li>
<li><code>integrity</code></li>
<li><code>keepalive</code></li>
</ul>
<p>The following node-fetch extension properties are provided:</p>
<ul>
<li><code>follow</code></li>
<li><code>compress</code></li>
<li><code>counter</code></li>
<li><code>agent</code></li>
</ul>
<p>See <a href="#fetch-options">options</a> for exact meaning of these extensions.</p>
<h3><a class="anchor" id="autotoc_md3224"></a>
new Request(input[, options])</h3>
<p><small>*(spec-compliant)*</small></p>
<ul>
<li><code>input</code> A string representing a URL, or another <code>Request</code> (which will be cloned)</li>
<li><code>options</code> [Options][#fetch-options] for the HTTP(S) request</li>
</ul>
<p>Constructs a new <code>Request</code> object. The constructor is identical to that in the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Request/Request">browser</a>.</p>
<p>In most cases, directly <code>fetch(url, options)</code> is simpler than creating a <code>Request</code> object.</p>
<p><a class="anchor" id="class-response"></a> </p>
<h2><a class="anchor" id="autotoc_md3225"></a>
Class: Response</h2>
<p>An HTTP(S) response. This class implements the <a href="#iface-body">Body</a> interface.</p>
<p>The following properties are not implemented in node-fetch at this moment:</p>
<ul>
<li><code>Response.error()</code></li>
<li><code>Response.redirect()</code></li>
<li><code>type</code></li>
<li><code>trailer</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md3226"></a>
new Response([body[, options]])</h3>
<p><small>*(spec-compliant)*</small></p>
<ul>
<li><code>body</code> A string or <a href="https://nodejs.org/api/stream.html#stream_readable_streams">Readable stream</a></li>
<li><code>options</code> A <a href="https://fetch.spec.whatwg.org/#responseinit"><code>ResponseInit</code></a> options dictionary</li>
</ul>
<p>Constructs a new <code>Response</code> object. The constructor is identical to that in the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Response/Response">browser</a>.</p>
<p>Because Node.js does not implement service workers (for which this class was designed), one rarely has to construct a <code>Response</code> directly.</p>
<h3><a class="anchor" id="autotoc_md3227"></a>
response.ok</h3>
<p><small>*(spec-compliant)*</small></p>
<p>Convenience property representing if the request ended normally. Will evaluate to true if the response status was greater than or equal to 200 but smaller than 300.</p>
<h3><a class="anchor" id="autotoc_md3228"></a>
response.redirected</h3>
<p><small>*(spec-compliant)*</small></p>
<p>Convenience property representing if the request has been redirected at least once. Will evaluate to true if the internal redirect counter is greater than 0.</p>
<p><a class="anchor" id="class-headers"></a> </p>
<h2><a class="anchor" id="autotoc_md3229"></a>
Class: Headers</h2>
<p>This class allows manipulating and iterating over a set of HTTP headers. All methods specified in the <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a> are implemented.</p>
<h3><a class="anchor" id="autotoc_md3230"></a>
new Headers([init])</h3>
<p><small>*(spec-compliant)*</small></p>
<ul>
<li><code>init</code> Optional argument to pre-fill the <code>Headers</code> object</li>
</ul>
<p>Construct a new <code>Headers</code> object. <code>init</code> can be either <code>null</code>, a <code>Headers</code> object, an key-value map object, or any iterable object.</p>
<div class="fragment"><div class="line">// Example adapted from https://fetch.spec.whatwg.org/#example-headers-class</div>
<div class="line"> </div>
<div class="line">const meta = {</div>
<div class="line">  &#39;Content-Type&#39;: &#39;text/xml&#39;,</div>
<div class="line">  &#39;Breaking-Bad&#39;: &#39;&lt;3&#39;</div>
<div class="line">};</div>
<div class="line">const headers = new Headers(meta);</div>
<div class="line"> </div>
<div class="line">// The above is equivalent to</div>
<div class="line">const meta = [</div>
<div class="line">  [ &#39;Content-Type&#39;, &#39;text/xml&#39; ],</div>
<div class="line">  [ &#39;Breaking-Bad&#39;, &#39;&lt;3&#39; ]</div>
<div class="line">];</div>
<div class="line">const headers = new Headers(meta);</div>
<div class="line"> </div>
<div class="line">// You can in fact use any iterable objects, like a Map or even another Headers</div>
<div class="line">const meta = new Map();</div>
<div class="line">meta.set(&#39;Content-Type&#39;, &#39;text/xml&#39;);</div>
<div class="line">meta.set(&#39;Breaking-Bad&#39;, &#39;&lt;3&#39;);</div>
<div class="line">const headers = new Headers(meta);</div>
<div class="line">const copyOfHeaders = new Headers(headers);</div>
</div><!-- fragment --><p><a class="anchor" id="iface-body"></a> </p>
<h2><a class="anchor" id="autotoc_md3231"></a>
Interface: Body</h2>
<p><code>Body</code> is an abstract interface with methods that are applicable to both <code>Request</code> and <code>Response</code> classes.</p>
<p>The following methods are not yet implemented in node-fetch at this moment:</p>
<ul>
<li><code>formData()</code></li>
</ul>
<h3><a class="anchor" id="autotoc_md3232"></a>
body.body</h3>
<p><small>*(deviation from spec)*</small></p>
<ul>
<li>Node.js <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>Readable</code> stream</a></li>
</ul>
<p>The data encapsulated in the <code>Body</code> object. Note that while the <a href="https://fetch.spec.whatwg.org/">Fetch Standard</a> requires the property to always be a WHATWG <code>ReadableStream</code>, in node-fetch it is a Node.js <a href="https://nodejs.org/api/stream.html#stream_readable_streams"><code>Readable</code> stream</a>.</p>
<h3><a class="anchor" id="autotoc_md3233"></a>
body.bodyUsed</h3>
<p><small>*(spec-compliant)*</small></p>
<ul>
<li><code>Boolean</code></li>
</ul>
<p>A boolean property for if this body has been consumed. Per spec, a consumed body cannot be used again.</p>
<h3><a class="anchor" id="autotoc_md3234"></a>
body.arrayBuffer()</h3>
<h3><a class="anchor" id="autotoc_md3235"></a>
body.blob()</h3>
<h3><a class="anchor" id="autotoc_md3236"></a>
body.json()</h3>
<h3><a class="anchor" id="autotoc_md3237"></a>
body.text()</h3>
<p><small>*(spec-compliant)*</small></p>
<ul>
<li>Returns: <code>Promise</code></li>
</ul>
<p>Consume the body and return a promise that will resolve to one of these formats.</p>
<h3><a class="anchor" id="autotoc_md3238"></a>
body.buffer()</h3>
<p><small>*(node-fetch extension)*</small></p>
<ul>
<li>Returns: <code>Promise&lt;Buffer&gt;</code></li>
</ul>
<p>Consume the body and return a promise that will resolve to a Buffer.</p>
<h3><a class="anchor" id="autotoc_md3239"></a>
body.textConverted()</h3>
<p><small>*(node-fetch extension)*</small></p>
<ul>
<li>Returns: <code>Promise&lt;String&gt;</code></li>
</ul>
<p>Identical to <code>body.text()</code>, except instead of always converting to UTF-8, encoding sniffing will be performed and text converted to UTF-8, if possible.</p>
<p>(This API requires an optional dependency on npm package <a href="https://www.npmjs.com/package/encoding">encoding</a>, which you need to install manually. <code>webpack</code> users may see <a href="https://github.com/bitinn/node-fetch/issues/412#issuecomment-379007792">a warning message</a> due to this optional dependency.)</p>
<p><a class="anchor" id="class-fetcherror"></a> </p>
<h2><a class="anchor" id="autotoc_md3240"></a>
Class: FetchError</h2>
<p><small>*(node-fetch extension)*</small></p>
<p>An operational error in the fetching process. See <a href="https://github.com/bitinn/node-fetch/blob/master/ERROR-HANDLING.md">ERROR-HANDLING.md</a> for more info.</p>
<p><a class="anchor" id="class-aborterror"></a> </p>
<h2><a class="anchor" id="autotoc_md3241"></a>
Class: AbortError</h2>
<p><small>*(node-fetch extension)*</small></p>
<p>An Error thrown when the request is aborted in response to an <code>AbortSignal</code>'s <code>abort</code> event. It has a <code>name</code> property of <code>AbortError</code>. See <a href="https://github.com/bitinn/node-fetch/blob/master/ERROR-HANDLING.md">ERROR-HANDLING.MD</a> for more info.</p>
<h1><a class="anchor" id="autotoc_md3242"></a>
Acknowledgement</h1>
<p>Thanks to <a href="https://github.com/github/fetch">github/fetch</a> for providing a solid implementation reference.</p>
<p><code>node-fetch</code> v1 was maintained by <a href="https://github.com/bitinn">@bitinn</a>; v2 was maintained by <a href="https://github.com/timothygu">@TimothyGu</a>, <a href="https://github.com/bitinn">@bitinn</a> and <a href="https://github.com/jimmywarting">@jimmywarting</a>; v2 readme is written by <a href="https://github.com/jkantr">@jkantr</a>.</p>
<h1><a class="anchor" id="autotoc_md3243"></a>
License</h1>
<p>MIT </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.18 </li>
  </ul>
</div>
</body>
</html>
